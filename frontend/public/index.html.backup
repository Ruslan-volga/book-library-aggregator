<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–π –ê–≥—Ä–µ–≥–∞—Ç–æ—Ä</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; }
        header { background: #2c3e50; color: white; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
        .api-section { background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        button { background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
        button:hover { background: #2980b9; }
        pre { background: #f8f9fa; padding: 15px; border-radius: 4px; overflow: auto; }
        .status { padding: 10px; border-radius: 4px; margin: 10px 0; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .loading { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö –ë–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–π –ê–≥—Ä–µ–≥–∞—Ç–æ—Ä</h1>
            <p>API –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–Ω–∏–≥ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö</p>
        </header>

        <div class="api-section">
            <h2>ü©∫ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è API</h2>
            <button onclick="checkHealth()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Health</button>
            <div id="health-status"></div>
        </div>

        <div class="api-section">
            <h2>üìñ –°–ø–∏—Å–æ–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫</h2>
            <button onclick="getLibraries()">–ü–æ–ª—É—á–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</button>
            <div id="libraries"></div>
        </div>

        <div class="api-section">
            <h2>üîç –ü–æ–∏—Å–∫ –∫–Ω–∏–≥</h2>
            <input type="text" id="search-book" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏">
            <button onclick="searchBooks()">–ù–∞–π—Ç–∏ –∫–Ω–∏–≥–∏</button>
            <div id="books"></div>
        </div>

        <div class="api-section">
            <h2>üîó –°—Å—ã–ª–∫–∏</h2>
            <ul>
                <li><a href="/api-docs" target="_blank">Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a></li>
                <li><a href="/api/health" target="_blank">Health check</a></li>
                <li><a href="/api/status" target="_blank">–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</a></li>
            </ul>
        </div>
    </div>

    <script>
        const API_BASE = '/api';
        
        function showStatus(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function formatJSON(data) {
            return `<pre>${JSON.stringify(data, null, 2)}</pre>`;
        }

        async function checkHealth() {
            showStatus('health-status', '–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ API...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/health`);
                const data = await response.json();
                showStatus('health-status', formatJSON(data), 'success');
            } catch (error) {
                showStatus('health-status', `–û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }

        async function getLibraries() {
            showStatus('libraries', '–ó–∞–≥—Ä—É–∂–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/libraries`);
                const data = await response.json();
                showStatus('libraries', formatJSON(data), 'success');
            } catch (error) {
                showStatus('libraries', `–û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }

        async function searchBooks() {
            const query = document.getElementById('search-book').value;
            showStatus('books', '–ò—â–µ–º –∫–Ω–∏–≥–∏...', 'loading');
            try {
                const url = query 
                    ? `${API_BASE}/libraries/books/search?title=${encodeURIComponent(query)}`
                    : `${API_BASE}/libraries/books/search`;
                const response = await fetch(url);
                const data = await response.json();
                showStatus('books', formatJSON(data), 'success');
            } catch (error) {
                showStatus('books', `–û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º API –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = checkHealth;
    </script>
</body>
</html>